<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jenkins</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>

  <body>
    <h1>Jenkins</h1>
    <h3>Pre-conditions to install</h3>
    <ul>
      <li>
        Install brew from
        <a href="https://brew.sh/"><span>HERE</span></a>
      </li>
      <li>
        Install jenkins from
        <a href="https://www.jenkins.io/"><span>HERE</span></a>
      </li>
    </ul>
    <h3>Glosary</h3>
    <ul>
      <li>
        Jenkins
        <ul>
          <li class="bullet-li">
            Server app for build and test with CI/CD process
          </li>
        </ul>
      </li>

      <li>
        Jenkins Job
        <ul>
          <li class="bullet-li">Scripts that we want to automate</li>
        </ul>
      </li>
      <li>
        Pipeline
        <ul>
          <li class="bullet-li">It is a set of stages</li>
        </ul>
      </li>
      <li>
        Stages
        <ul>
          <li class="bullet-li">
            The stages block contains most of the work that the pipeline
            performs
          </li>
        </ul>
      </li>
      <li>
        Jenkins agents
        <ul>
          <li class="bullet-li">
            Program that executes the stages, it can be multiple stages for
            balnce the load
          </li>
        </ul>
      </li>
      <li>
        Process in CI/CD
        <ul>
          <li class="bullet-li">Code compilation</li>
          <li class="bullet-li">Run test</li>
          <li class="bullet-li">Build a new version of the app</li>
          <li class="bullet-li">Deploy the app to the server</li>
        </ul>
      </li>
    </ul>

    <h3>Jenkins commands</h3>
    <ul>
      <li>
        Shell commands for Jenkins projects
        <a href="./linux-shell-for-jenkins.html"><span>HERE</span></a>
      </li>
      <li>
        Install jenkins with brew
        <span class="terminal-commands">&nbsp;brew install jenkins-lts</span>
      </li>
      <li>
        Start Jenkins service
        <span class="terminal-commands"
          >&nbsp;brew services start jenkins-lts</span
        >
      </li>
      <li>
        Restart the Jenkins service
        <span class="terminal-commands"
          >&nbsp;brew services restart jenkins-lts</span
        >
      </li>
      <li>
        Update the Jenkins version
        <span class="terminal-commands">&nbsp;brew upgrade jenkins-lts</span>
      </li>
      <li>
        Stop jenkins services
        <span class="terminal-commands"
          >&nbsp;brew services stop jenkins-lts</span
        >
      </li>
    </ul>
    <h3>Jenkins initial set-up</h3>
    <ol>
      <li>
        Start Jenkins service
        <span class="terminal-commands"
          >&nbsp;brew services start jenkins-lts</span
        >
      </li>
      <li>
        Navigate to the local host 8080
        <a href="http://localhost:8080"><span>HERE</span></a>
      </li>
      <li>
        Search for the path displayed in the jenkins login page to get the
        initial key
      </li>
      <li>Search the secret key from the file path</li>
      <li>
        Paste the key in the password field for starting configuration process
      </li>
      <li>Install suggested plugins</li>
      <li>Create an admin user</li>
    </ol>

    <h3>Install pluggins</h3>
    <ul>
      <li>Go to the left menu manage jenkins</li>
      <li>Select pluggins</li>
      <li>open available pluggins section</li>
      <li>
        Useful pluggins:
        <ul>
          <li class="bullet-li">NodeJS</li>
          <li class="bullet-li">
            AnsiColor (avoid special characters in the console results)
          </li>
          <li class="bullet-li">
            HTML Publisher plugin (html report for execution)
          </li>
          <li class="bullet-li">Docker pipeline</li>
        </ul>
      </li>
    </ul>
    <h3>How to publish a HTML report to a pipline</h3>
    <ul>
      <li>Install HTML Publisher plugin</li>
      <li>Search at the end of the pipline config, pipline syntax</li>
      <li>In sample step add the html report pluggin</li>
      <li>
        in html directory, add the path in where the test results are saved
      </li>
      <li>In index, add the report file created usually is index.html</li>
      <li>In report title, add a name to your report</li>
      <li>Press on generate pipeline script</li>
      <li>Copy and paste to your post action in your jenkis file</li>
      <img
        class="m-size-35"
        src="../img/jenkins/publish-html-report.png"
        alt="publishHtml-report"
      />
    </ul>
    <h3>How to create a free style project</h3>
    <ul>
      <li>Left menu/ new item</li>
      <li>Add a name to a free style project</li>
      <li>
        In General options start to fill the project configurations parameters
      </li>
      <ul>
        <li>
          In git hub project field, you can add your project repo from github
        </li>
        <li>
          In use custom work space, add the path in where your project will be
          allocated after each jenkins build
        </li>
      </ul>
      <img
        class="m-size-50"
        src="../img/jenkins/generalexecutionoption.png"
        alt="general"
      />
    </ul>
    <h3>Set up node environment in a free style project</h3>
    <ul>
      <li>Go to you jenkins project and configure settings</li>
      <li>In build environment check Provide Node & npm bin/ folder to PATH</li>
      <li>Select the node configuration previously setted</li>
      <li>Leave the other parameters by default</li>
      <img
        class="m-size-50"
        src="../img/jenkins/nodeEnvironment.png"
        alt="buildEnvironment"
      />
      <li>In build stepts section, add execute shell</li>
      <li>
        Add the npm command that you have in your project script from your
        package.json
      </li>
      <img
        class="m-size-50"
        src="../img/jenkins/buildStepsts.png"
        x
        alt="buildStepts"
      />
    </ul>

    <h3>How to create a new pipeline</h3>
    <ul>
      <li>Left menu/ new item</li>
      <li>Add a name to pipeline</li>
      <li>
        In pipline section you will be able to create a new piple "use groovy"
      </li>
      <li>With sh command create scripts for linux</li>
      <li>
        Usefully linux commands
        <a href="../web/linux-shell.html">Here</a>
      </li>
      <img
        class="m-size-35"
        src="../img/jenkins/ui-pipeline-.png"
        alt="pipelines"
      />
      <li>Save and build the pipline created</li>
      <li>
        Access to the executed job and you will be able to see the console
        output
      </li>
      <img
        class="m-size-50"
        src="../img/jenkins/console-output.png"
        alt="console"
      />
    </ul>
    <h3>Create a SCM pipeline</h3>
    <ul>
      <li>Create a jenkinsfile inside your project</li>
      <li>Designe your pipeline project in the jenkins file created</li>
      <li>Create a new pipeline project in jenkins</li>
      <li>In build steps configure:</li>
      <ul>
        <li>Add a description of your project</li>
        <li>Select SCM instead pipeline</li>
        <li>Select GIT</li>
        <li>Add the http github path where your project is</li>
        <li>Select the branch where your project is */main or */master</li>
        <li>
          In the script path add the path where your jenkins file is `key
          sensitive`
        </li>
        <img
          class="m-size-50"
          src="../img//jenkins/SCM-pipeline.png"
          alt="path to files created"
        />
      </ul>
    </ul>

    <h3>How to add a set of steps into one in a pipeline</h3>
    <ul>
      <li>sh is a common sintax for all commands</li>
      <img
        class="m-size-35"
        src="../img/jenkins/groupCommands.png"
        alt="pipelines"
      />
      <li>Save and build the pipline created</li>
    </ul>

    <h3>Creates and use variables</h3>
    <ul>
      <li>Create an envirtonment object before stages</li>
      <li>Create a variable (use caps)</li>
      <li>use the variable adding '$variableName'</li>
      <img
        class="m-size-50"
        src="../img//jenkins/Pipeline-variables.png"
        alt="pipeline-variable"
      />
    </ul>
    <h3>Reuse node workspaces to avoid creating multiples folders</h3>
    <ul>
      <li>
        This may work when you have dependencies between workspaces in jenkins
      </li>
      <li>add: reuseNode true</li>
      <img
        class="m-size-35"
        src="../img//jenkins/reuseNode-workspace.png"
        alt="reuseNode-workspace"
      />
    </ul>

    <h3>Acces to the files or folders created in a pipeline</h3>

    <ul>
      <li>Open the build executions options, select the section workspaces</li>
      <li>
        Click on the path displayed (is where the files created are located)
      </li>
      <img
        class="m-size-35"
        src="../img//jenkins/filesCreated.png"
        alt="path to files created"
      />
      <li>Remove logs and files from the workspace</li>
      <li>Create post stage that cleans the workspace</li>
      <img
        class="m-size-35"
        src="../img//jenkins/clean-workspace.png"
        alt="path to files created"
      />
    </ul>
    <h3>
      Creates a Post acction that stores all logs and files in artifact path
    </h3>
    <ul>
      <li>Add a post action in the pipeline creating an artifact</li>
      <img
        class="m-size-35"
        src="../img//jenkins/artifacts-folder.png"
        alt="path to files created"
      />
      <li>Inside the build options you will se the artifact path</li>
      <li>You will be able to click and open the artifacts</li>
      <img
        class="m-size-35"
        src="../img//jenkins/open-artifact.png"
        alt="path to files created"
      />
    </ul>
  </body>
</html>
